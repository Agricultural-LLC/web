---
import type { BlogEntry } from "@/types";
import { formatDate } from "@lib/formatDate";
import readingTime from "@lib/readingTime";
import { slugify, smartTruncate, upperHumanize } from "@lib/textConverter";
import {
FaRegCalendarAlt,
FaRegClock,
FaRegFolder
} from "react-icons/fa";

interface Props {
  entry: BlogEntry;
}

const { entry }: Props = Astro.props;
const {
  title,
  description,
  autodescription,
  date,
  categories,
  tags,
  complexity,
} = entry;
const baseURL = import.meta.env.BASE_URL;

const descriptionLength = 200;

const entryDate = date ? formatDate(date) : null;
const entryReadingTime = readingTime(entry.body!, complexity);
const entryDescription =
  description ||
  (autodescription ? smartTruncate(entry.body!, descriptionLength) : null);
---

<div class="h-full m-2 pl-0 bg-gradient-to-br gradient rounded-lg">
  <div class="glass h-full rounded-lg p-6 intersect:animate-fadeUp opacity-0">
    <h4 class="mb-4 text-lg font-semibold leading-relaxed">
      <a href={`${baseURL}agritech/${entry.slug}/`} class="hover:text-primary transition-colors dark:text-white">
        {title}
      </a>
    </h4>
    <ul class="mb-4 flex flex-wrap gap-3 text-sm">
      {
        categories && (
          <li class="inline-block">
            {categories.map((category: string, index: number) => (
              <a href={`${baseURL}agritech/categories/${slugify(category)}/`} class="inline-flex items-center gap-1 hover:text-primary transition-colors">
                <FaRegFolder className={"-mt-0.5"} />
                {upperHumanize(category)}
              </a>
            ))}
          </li>
        )
      }
      <!-- { tags && (
        <li class="mr-0 inline-block">
          {
            tags.map((tag: string, index: number) => (
              <a href={`${baseURL}agritech/tags/${slugify(tag)}/`}>
                <FaHashtag className={"ml-2 -mt-1 inline-block"} />
                {lowerHumanize(tag)}
              </a>
            ))
          }
        </li>
      )} -->
      {
        entryDate && (
          <li class="inline-block">
            <span class="inline-flex items-center gap-1 text-gray-600 dark:text-gray-400">
              <FaRegCalendarAlt className={"-mt-0.5"} />
              {entryDate}
            </span>
          </li>
        )
      }
      {
        complexity > 0 && (
          <li class="inline-block">
            <span class="inline-flex items-center gap-1 text-gray-600 dark:text-gray-400">
              <FaRegClock className={"-mt-0.5"} />
              {entryReadingTime}
            </span>
          </li>
        )
      }
    </ul>
    <p class="text-base leading-relaxed text-gray-700 dark:text-gray-300 whitespace-pre-line">
      {entryDescription}
    </p>
  </div>
</div>
